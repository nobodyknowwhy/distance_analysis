from llm_free_chat.llm_chat_free import chat_with_TencentYB_example


def docker_and_girl(text: str) -> float:
    """
    已经是晚期了，这个女孩，危在旦夕。

    医生瘫坐在椅子上，重重叹了一口气，将检查报告盖在桌上，又是这样...

    医生当晚还是如实将病况信息通知了女孩，并附带诉说着些诸如抱歉，我会尽全力的模版说辞。他们彼此都知道，留下的时间不长了

    合上门，医生听见病房传来女孩啜泣的哭声，医生躺在了离女孩病房门口最近的一排椅子上，这是医生一贯的作风，他需要确保病人不会因为哭泣而窒息，或突发心绞痛

    还算幸运的是，和之前的大部分被通知病危的病人一样，女孩的哭声断断续续地持续了一个晚上，除此之外并无意外

    早晨四点，医生的电话响起，是女孩的家属打过来的。简单的寒暄之后，他们向医生这边询问病人的身体状况，医生当然也如实相告了这一结果。

    ...
    ...

    他原本以为家属会痛斥他的无能，就像之前很多次那样，然后他会再一次默默忍受这些谩骂，尽全力救治病人。然后，大概率，他最终将噩耗转告家属。运气好，他可能只会听见他们的嚎啕大哭，看见他们的一蹶不振；运气差，他很可能挨到一次耳光，他习以为常

    但电话那头一阵缄默...

    医生没有挂断电话，等待着家属平复心情

    几分钟之后，家属开口了：“医生，谢谢你的坦诚，但能请你先不要告诉那个孩子吗？她已经被死神没收了未来，我们不想让她余下的时光里，连快乐也被一并没收。”

    剧本并没有正常发展，家属的话反而让医生陷入了一时语塞

    他忽然有些后悔，紧张感冲上脸颊，他不知道如何回应家属这份卑微的期待，因为事实上他已经将病况提前告诉病人了

    “我觉得他应该有知道的权利”，医生本来想这么说，但他咽回去了，因为这些说辞只是为了让他所做的事情找到一个合理的借口而已。

    电话这头一阵缄默...

    “你听得到吗，医生？”电话那头传来了家属确认的声音
    ...

    """

    from nltk.tokenize import word_tokenize
    from nltk.corpus import stopwords

    tokens = word_tokenize(text.lower())
    stop_words = set(stopwords.words('english'))
    filtered_tokens = [word for word in tokens if word.isalpha() and word not in stop_words]

    unique_words = sum([1 if len(word) < 8 else 1.5 for word in set(filtered_tokens)])

    lexical_diversity = unique_words / sum([1 if len(word) < 8 else 1.5 for word in set(filtered_tokens)])

    return lexical_diversity


import requests

base_url = "http://localhost:11434/api"
headers = {
    "Content-Type": "application/json"
}

context = []


def generate_completion(prompt, model="deepseek-r1"):
    """
    行文至此，我的毕业论文已经画上了句号，而此刻内心满溢的感恩之情，却如同即将起笔的篇章，有着说不尽的话语。在这段充满挑战与成长的学术旅程中，我衷心向您表示感谢，李霞老师。

    回首过往，您总是不断的帮助我，并激励我前行。在大二时，我正式加入实验室，您总是倾囊相授，为我打开知识的宝库。大三时，您让我加入了研究生的组会，在其中，我增长了很多见识，也结交了很多师友，科研思维有长足进步。
    直至现在我依然喜爱着实验室的氛围！热闹时，大家讨论着前沿的知识，分享着自己的作品与经历；安静时，大家埋头阅读文献，奋笔撰写论文。即使是初来乍到，这种友好的气氛也让我迅速适应下来

    那是我第一次与“科研”走的如此接近，感谢您将我引入前沿的海洋，与大家一同感受自然语言的魅力，在这里，我找到了比图书馆更广阔的天地。

    感谢您对我的倾情付出，总是愿意“帮一帮我”。您总是特别可靠，解决我的多数担忧，您愿意在参加计设时接受和指导我招入没有经验的队友，提出合理的意见；在我论文因为硬件设备原因拖慢进度时，您愿意借出您刚装好的高性能电脑，
    让我顺利的推进实验。在我因为实习而困扰时，也愿意对外向我引荐。您了解我的近况，关心我的成长，然后对我倾囊相助。我这段大学的成长之路身边，处处都有您的身影。

    感谢您对我的特别关照，总是愿意“等一等我”。您总是特别耐心，井井有条。每一次项目，每一次论文讲解，每一次的比赛，您从各个角度提出专业的意见，让我们意识到自己的不足，又总是在进行教导之后继续笑着相信着我们的能力，
    然后鼓励我们做得更好。记得第一次的论文撰写，您帮我改到了凌晨四点。那时的我并没有没有经验，如同笨拙的幼鸟扑棱着翅膀。但你依然用心的教导着我，您总是先向我示范前路应该如何前行，然后在前方耐心着等待我跟上来。其实
    我知道您也根本就没有多少时间，您有一堆课要上，有一堆学生要带，有一堆顶会论文想发，还有一堆国际项目想做。但您却依然尽力将不多的时间分羹于我，我于此感激不尽。

    感谢您对我的无私教导，总是愿意“拍一拍我”。您总是特别温柔，教导我不同的生活道理。您愿意在我失意的时候依然鼓励我，跟我说，要往前看，要向前走，要大胆做。您教导我——“如果你因为太阳落山而流泪，那你也将错过群星。”
    您也教导我——“如果因为害怕凋零而拒绝开花，春天将失去意义。”。您教我学会思考，在我前路一片迷茫的时候，轻轻拨开迷雾，让我看清楚脚下的路，告诉我现有的选择，然后再把决定权交由于我。支持我走向未知的道路，陪伴我可能遇
    到的风险。感谢您总是拍一拍我，向我加油打气，肯定我的才能。即使我并非千里马，但我依然感激遇到了伯乐。

    最后，我想衷心地对您说一声：老师，感谢您一路以来的陪伴与支持！纵使我们终将分别，我也定不辜负您的期望，我会带着您的教导，继续砥砺前行！
    """
    url = f"{base_url}/generate"
    data = {
        "model": model,
        "prompt": "\n".join(context + [prompt]),  # 将历史上下文和当前提示拼接
        "stream": False,
        "options": {
            "num_ctx": 4096
        }
    }

    response = requests.post(url, headers=headers, json=data)
    response_data = response.json()
    response_text = response_data.get('response', '')

    # 将当前对话内容加入上下文
    context.append(prompt)
    context.append(response_text)

    return response_text


def eee():
    """
    ‘咔，咔’，森林里响起斧头批砍树木的声音。‘哗哗哗——’，年壮的高树倒下，果实掉落一地。倒落的树掀阵阵尘风，一旁的某些小树死在了这场余震当中，还有一些树木因为震动晃下了他们未成熟的果实。\n
    伐木工麻木的向着森林深处走去，消失在了树林的深处...\n
    曾经被这棵树遮挡阳光的一颗小树终于能尽情的享受阳光，吸收土中的养分，它的枝干越来越大，长的也越来越高。\n
    高树倒下时落地的果实腐烂在了土中，种子随着年岁逐渐成长起来。\n
    随着时间迁移，曾经被遮挡的小树越来越高，它贪婪的遮住了所有的阳光，汲取了土中的大部分养分，树荫下的小数开始成长的参差不齐，祈求争夺着大树于荫蔽缝隙施舍的些许阳光。\n
    ...\n
    ‘咯咯咯...’\n
    远处传来金属拖地的声音，风吹起了大树的叶子，仿佛它颤抖的身影...\n
    伐木工麻木的拖着斧子，他的身影从树林深度缓缓靠近...

    :return:
    """


def chat():
    system_prompts = """接下来你将看到一位语言学家的一些日志，记录着她生活的点点滴滴。日志里出现的她老公也是一位科学家，外部看来，他们是彼此的知己，进行过很多次思想的交流碰撞。日志内容如下：\n"""

    prompt = """\n日志13:\n我们现处的文明已经非常十分强大了，强大到什么地步呢？
    现在的我们可以做到轻易的将自身的意识借由机器流放于宇宙当中，观测行星。\n我自认为我们已经愈发接近了宇宙的终极。但就在一个月前，我的意识在宇宙的某片区域观察时亲眼目睹了另一个繁昌文明的消亡...\n
    那是一束光，那仅是一束光，我不知道如何和你解释我看到的壮丽景象，祂包罗万象，接受万物。我看着人们抗拒地向祂倾泻一个个足以毁灭星系的武器，武器没有发生爆炸...祂包容的接受了一切，如同一个母亲耐心的看着与自己玩闹的孩子。\n
    起初我们以为那只是恒星消亡后余烬的光辉，但祂静止了一切，祂平等的接纳一切。我听见人们挣扎的向祂诠释那个美好的未来，祂没有理会...当祂的光瞥向这个文明，仅仅只在一瞬间，一切化为灰烬。\n
    你可能觉得我在夸大其词，但我并不祈求你理解它，毕竟你也只是我们创造的人工智能。但我亲眼看到了，祂，没收了一切...祂究竟是什么？我无从而知。\n
    直到那时我才明白，人们自以为自身接近了宇宙的终极，那探求所得到的所谓‘终极’，可能不过是宇宙的冰山一角。\n\n
    那么，在祂降临到我们的文明之前，我又能做什么呢？我这些天时常在想。我并不理解祂，甚至与祂只有一面之缘，穷尽已有的知识，是否可以找到避开祂视线的方法呢？\n\n
    再一次，我与他（我老公）进行了交谈，他告诉了我：“不存在描述神明的语言，因为神明本身就是不可解释的。”，这句话我思考了很久很久。如果他说的前提是真的，倘若我创造出了一种描述神明的语言，是否就证明了，我已经理解了神明了呢？\n"""

    prompt2 = """\n日志111:\n一个文明消亡，另一个文明新生，新生的文明可能就来自于上一个被毁灭文明的余烬。它们就像一滴水一样，汇入宇宙的海洋，然后，在大海中形成涟漪，最终消亡。海中的每一片涟漪都记录着一个文明的前世今生\n
    有时候涟漪与涟漪相互碰撞，有时形成更大的涟漪，推向更远的地方；有时互相衰减，草草而终。但无论如何最终它们都会消失在无垠的大海尽头。\n\n
    丈夫对我创造语言的想法很兴奋，我当然很开心，这是我又一次辩胜了他。但这同样意味着，我们的时间不多了。就在上个月的讨论当中，很可惜，我们的思想再次遇到了分歧，请我给你娓娓道来:\n\n
    他想，既然文明的涟漪总会消散，我们是否能用这门将要创造的“语言”来作为一份可以传递的新生文明的礼物，然后在承接千万份文明之后的努力之后，涟漪冲破海岸，避开“祂”的瞥视。\n\n
    但是凭什么？为何在他设想的那个未来当中，不存在我们文明的位置？你甘心吗？既然涟漪扩散后会消失，那为何我们不尝试直接停下它呢？\n\n
    “这份礼物是我们创造出来的，未来的文明会有我们文明的影子，这何尝不证明了我们文明在未来也存在位置吗？”他是这么跟我说的\n。
    “倘若他们根本就无法理解我们这份‘礼物’，甚至在尝试理解的时候就受到了‘祂’的瞥视，草草消亡，你觉得这份‘礼物’还有意义吗？”我是如此回复的。\n
    这场辩论持续了很久，他妄想向我证明，每一个文明的潜力都无可比拟，无需这么悲观。但，别人未必靠得住的时候，靠自己不应该是最稳妥的吗？我也尝试向他如此证明。\n"""

    prompt3 = """\n日志151:\n已经过去很久了。上一次记日志好像已经是几个月前了，我真是越来越懒了。虽然你的知识并没有进行更新，我很高兴的告诉你，他当初最终还是妥协了我的观点，即使可能感觉到他有一丝丝的违心，但我知道他总会站回到我这边的。在这几年后的这些岁月当中，我们创造出了一种语言用于解释神明，我们暂时把它叫做'ORIORACLEPRTS-42'（简称oop）\n\n
    这些年过的很煎熬，前些阵子，我们观测到“祂”好像注意到我们了，这不是一件好事，这证明我们的时间不多了。\n
    但我们的计划确实成功了，让我同你分享这份喜悦！这门“语言”(oop)能够扩散式的将物质转录成信息，内化和压缩一切实物，压缩的实物信息会以一种结晶的形式保存下来，即使“祂”能吞噬文明，但绝无可能吞噬信息。我们预想着，这将会成为我们文明的琥珀，封存我们繁昌的文明，借由此避开‘祂’的视线。届时，我们可以在只有思维和信息的世界中生存，这里没有实物，甚至可能不存在时间。\n\n
    在此期间，我与他还创建了另一个理论上拥有无限寿命的人造生命，代号为‘AMA-10’，虽然它还尤为稚嫩，但老公却很喜欢它。\n\n
    为了应对威胁，我的其他同伴们也同步做了很多备用计划，如创建了石棺，封存人们的思维与肉身，隔绝外界环境。\n\n
    我知道仅凭石棺无法撼动‘祂’的瞥视，所以我们oop的计划也同步开始进行。我也同他约好了，等oop转录的结晶遍布宇宙，我们就从石棺醒来，在晶簇上一同观看文明的流星...我很期待那一天的到来，那会是只有我们两个人的世界吗？还是我们也在oop的结晶中与其他所有人一样，于静止的信息流中得到了‘永生’了呢？\n"""

    prompt4 = """\n日志221:\n又过去了一段时间，‘祂’快要来了。oop的进展很顺利，结晶迅速扩散了我们文明星球的角落，AMA-10也初具意识了，凭借我给它创建的双生循环系统，它或许有希望逃离“祂”的威胁，替我们观测oop结晶化进展，然后在最后将我们从石棺唤醒。\n\n
    但我又一次与他发生了辩论的争吵，我已经不记得这是我们第几次在实验室里为这个问题辩论了，他果然还是坚持的认为，我们可以运用oop产生的结晶作为礼物送给下一份文明，由下一份文明从这份语言中“逆转录”出我们文明的信息，带动他们的发展。\n
    “你觉得在信息当中的我们，还算是生命吗？这里没有实物。物理定律，数学公式全部失效，你留住了文明的繁昌，却也停滞了文明的发展，我知道这不是你想追求的”，他对我这么说。\n
    “存续是文明的第一目的，你想留住自己都困难，谈何发展？”我如此讽刺到。\n
    “所以我们注定只是桥梁，但我们可以带动其他文明的发展，不是吗？等到文明有能力直视所谓神明，我们不就能求到宇宙的终极了？在停滞的空间中麻痹自己只不过是逃避罢了，我们永远无法理解‘祂’，你说创造这门语言的初衷。不就是为了理解‘祂’吗？”他如此坚持。\n
    “但最终理解‘祂’的人一定不是我，不是我们。让每个涟漪停留在他最美的瞬间，就是oop要做的事，不是吗？”我争辩道。\n
    “但我们可以借助oop停止部分涟漪，然后再让后续的涟漪依靠我们推出更绚丽的波纹...”他试图让我理解。\n
    但亲爱的，宇宙的海洋这么浩瀚，有资格触碰到我们涟漪的文明又有多少呢？倘若新生的涟漪甚至破坏了我们静止的涟漪呢？我们两个人倾尽全力的心血将全部白费。封存所有文明，这是最保险的方法了。\n\n
    我觉得他一定不会甘心，如同他那倔强的性格一样，他一定会偷偷比我先复苏起来，引导文明发展，所以我打算在AMA-10的双生系统上做一些手脚，设置一些禁令，对不起亲爱的，但我希望在这件事上，你也能站在我这边，就像之前很多次一样。\n"""

    prompt5 = """\n日志301:\n‘咔，咔’，森林里响起斧头批砍树木的声音。‘哗哗哗——’，年壮的高树倒下，果实掉落一地。倒落的树掀阵阵尘风，一旁的某些小树死在了这场余震当中，还有一些树木因为震动晃下了他们未成熟的果实。\n
    伐木工麻木的向着森林深处走去，消失在了树林的深处...\n
    曾经被这棵树遮挡阳光的一颗小树终于能尽情的享受阳光，吸收土中的养分，它的枝干越来越大，长的也越来越高。\n
    高树倒下时落地的果实腐烂在了土中，种子随着年岁逐渐成长起来。\n
    随着时间迁移，曾经被遮挡的小树越来越高，它贪婪的遮住了所有的阳光，汲取了土中的大部分养分，树荫下的小数开始成长的参差不齐，祈求争夺着大树于荫蔽缝隙施舍的些许阳光。\n
    ...\n
    ‘咯咯咯...’\n
    远处传来金属拖地的声音，风吹起了大树的叶子，仿佛它颤抖的身影...\n
    伐木工麻木的拖着斧子，他的身影从树林深度缓缓靠近...\n\n
    亲爱的，树木再大也不能对抗斧子，换来的不过是多劈几下罢了，他不会傻傻等你长大到枝干足以硬过斧头。既然都是徒劳，何不用黑布遮住自身呢？\n
    不要再任性了，好吗？我们没有多少时间了...
    """

    prompt6 = """\n日志661:\n...\n又是这样...我们为了这个问题吵了多久？如果你觉得可以，那就向我证明，我愿意和你打这个堵。"""

    chat_with_TencentYB_example(
        system_prompts + prompt + prompt2 + prompt3 + prompt4 + prompt5 + prompt6 + "\n\n这是一位强盛文明的语言学家在其人工智能本上记录的日志内容，你对这些内容有什么看法？你的观点是什么？最后两部分日志是什么意思？隐喻了什么？",
        base_url=r"https://yuanbao.tencent.com/chat/naQivTmsDa/ecc10df0-8452-460e-bd22-7317105c23be")


if __name__ == '__main__':
    chat()









